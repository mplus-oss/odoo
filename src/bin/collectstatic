#!/usr/bin/env bash

cd /opt/odoo

if [[ -d "s/openerp" ]]; then
	addons_dirs="s/openerp/addons ${ODOOCONF__options__addons_path//,/ }"
else
	addons_dirs="s/odoo/addons ${ODOOCONF__options__addons_path//,/ }"
fi


for addons_dir in $addons_dirs; do
    echo "Collecting static files from $addons_dir"
    ls $addons_dir -1 | while read addon_dir; do
    	static_dir="$addons_dir/$addon_dir"
	if [[ -d "$static_dir"/static ]]; then
	   mkdir -p "static/$addon_dir/static"
	   cp -r "$static_dir"/static/* "static/$addon_dir/static"
	fi
    done
done